{"version":3,"sources":["services/CommonTypes.ts","pages/Home.tsx","components/ImageUpload.tsx","components/MovieForm.tsx","services/MovieService.ts","pages/movie/AddMovie.tsx","pages/movie/EditMovie.tsx","components/MovieTable.tsx","redux/actions/MovieAction.ts","pages/movie/MovieList.tsx","pages/Layout.tsx","redux/reducers/MovieReducer.ts","redux/reducers/RootReducer.ts","redux/store.ts","App.tsx","index.tsx"],"names":["SwitchType","React","Component","state","showModal","this","props","curImageUrl","PlusOutlined","uid","name","url","p","formData","FormData","append","filename","file","request","Request","action","method","body","fetch","then","res","json","resp","err","message","error","onChange","data","listType","accept","fileList","getFileList","customRequest","handleRequest","bind","onRemove","onPreview","setState","getUploadContent","width","visible","onCancel","footer","alt","style","margin","src","AllAreas","label","value","AllTypes","MovieForm","image","movie","values","a","poster","onSubmit","success","console","log","onSuccessCallback","errorInfo","initialValues","labelCol","span","wrapperCol","offset","onFinish","onFinishFailed","Item","rules","required","valuePropName","getValueFromEvent","newUrl","Group","options","min","step","TextArea","type","htmlType","MovieService","axios","post","id","put","delete","get","condition","params","add","history","push","undefined","getMovieById","match","rep","edit","onLoad","onSearch","padding","marginBottom","display","key","e","onKeyChange","target","onPressEnter","handleSearch","size","marginRight","onClick","title","dataIndex","render","height","preview","fallback","filterDropdown","getFilterDropDown","filterIcon","SearchOutlined","text","join","timeLong","change","record","checked","newVal","onSwitchChange","isHot","_id","isComing","isClassic","to","onConfirm","onDelete","okText","cancelText","total","current","page","pageSize","limit","pagination","onPageChange","rowKey","dataSource","columns","getColumns","loading","isLoading","getPageConfig","handleChange","saveMoviesAction","movies","payload","setLoadingAction","setConditionAction","deleteAction","changeSwitchAction","fetchMovies","dispatch","getState","curCondition","getMovies","deleteMovie","changeSwitch","connect","MovieAction","newState","newPage","newKey","MovieTable","Header","Layout","Sider","Content","_Layout","className","mode","theme","path","component","Home","exact","MovieList","AddMovie","EditMovie","defaultState","totalPage","saveMovie","Object","assign","Math","ceil","setCondtion","setLoading","filter","m","find","d","newMovie","newData","map","rootReducer","combineReducers","store","createStore","applyMiddleware","thunk","logger","App","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.f69ae03e.chunk.js","sourcesContent":["export interface IResponseError {\r\n  err: string\r\n  data: null\r\n}\r\n\r\nexport interface IResponstData<T> {\r\n  err: \"\"\r\n  data: T\r\n}\r\n\r\n\r\nexport interface IResponstPageData<T> {\r\n  err: \"\"\r\n  total: number\r\n  data: T\r\n}\r\n\r\nexport interface ISearchCondition {\r\n  page?: number\r\n  limit?: number\r\n  key?: string\r\n}\r\n\r\nexport enum SwitchType {\r\n  isHot = \"isHot\",\r\n  isComing = \"isComing\",\r\n  isClassic = \"isClassic\"\r\n}\r\n","import React from \"react\";\r\n\r\nexport default class extends React.Component {\r\n  render() {\r\n    return (\r\n      <h1>\r\n        电影首页\r\n      </h1>\r\n    )\r\n  }\r\n}","import { message, Modal, Upload } from \"antd\";\r\nimport { PlusOutlined } from '@ant-design/icons';\r\nimport React from \"react\";\r\nimport { UploadFile } from \"antd/lib/upload/interface\";\r\nimport { IResponseError, IResponstData } from \"../services/CommonTypes\";\r\n\r\ninterface IImageUploadProps {\r\n  curImageUrl?: string\r\n  onChange?: (imageUrl: string) => void\r\n}\r\ninterface IShowState {\r\n  showModal: boolean\r\n}\r\nexport default class extends React.Component<IImageUploadProps, IShowState> {\r\n  state: IShowState = {\r\n    showModal: false\r\n  }\r\n\r\n  private getUploadContent() {\r\n    if (this.props.curImageUrl) {\r\n      return null\r\n    } else {\r\n      return (\r\n        <div>\r\n          <PlusOutlined></PlusOutlined>\r\n          <div>点击上传</div>\r\n        </div>\r\n      )\r\n    }\r\n  }\r\n\r\n  private getFileList(): UploadFile[] {\r\n    if (this.props.curImageUrl) {\r\n      return [{\r\n        uid: this.props.curImageUrl,\r\n        name: this.props.curImageUrl,\r\n        url: this.props.curImageUrl\r\n      }]\r\n    }\r\n    return []\r\n  }\r\n  private async handleRequest(p: any) {\r\n    let formData = new FormData()\r\n    formData.append(p.filename, p.file)\r\n\r\n    const request = new Request(p.action, {\r\n      method: \"post\",\r\n      body: formData\r\n    })\r\n\r\n    const resp: IResponseError | IResponstData<string> = await fetch(request).then(res => res.json())\r\n\r\n    if (resp.err) {\r\n      message.error('上传失败')\r\n    } else {\r\n      if(this.props.onChange) {\r\n        this.props.onChange(resp.data!)\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Upload\r\n          action=\"/api/upload\"\r\n          name=\"imagefile\"\r\n          listType=\"picture-card\"\r\n          accept=\".jpg,.png,.jiff,.jpeg,.bmp,.gif\"\r\n          fileList={this.getFileList()}\r\n          customRequest={this.handleRequest.bind(this)}\r\n          onRemove={\r\n            () => {\r\n              if(this.props.onChange) {\r\n                this.props.onChange('') \r\n              }\r\n            }\r\n          }\r\n          onPreview={\r\n            () => {\r\n              this.setState({\r\n                showModal: true\r\n              })\r\n            }\r\n          }\r\n        >\r\n          {this.getUploadContent()}\r\n        </Upload>\r\n        <Modal\r\n          width={500}\r\n          visible={this.state.showModal}\r\n          onCancel={() => {\r\n            this.setState({\r\n              showModal: false\r\n            })\r\n          }}\r\n          footer={[]}\r\n        >\r\n          <img alt=\"example\" style={{ width: '95%', margin: 'auto' }} src={this.props.curImageUrl} />\r\n        </Modal>\r\n      </div>\r\n    )\r\n  }\r\n}","import { Button, Checkbox, Form, Input, InputNumber, message, Switch } from \"antd\";\r\nimport React from \"react\";\r\nimport { IMovie } from \"../services/MovieService\";\r\nimport ImageUpload from \"./ImageUpload\";\r\nimport \"reflect-metadata\"\r\n\r\nconst AllAreas: { label: string, value: string }[] = [\r\n  { label: '中国大陆', value: '中国大陆' },\r\n  { label: '中国香港', value: '中国香港' },\r\n  { label: '韩国', value: '韩国' },\r\n  { label: '日本', value: '日本' },\r\n  { label: '美国', value: '美国' }\r\n];\r\nconst AllTypes: { label: string, value: string }[] = [\r\n  { label: '爱情', value: '爱情' },\r\n  { label: '喜剧', value: '喜剧' },\r\n  { label: '动作', value: '动作' },\r\n  { label: '战争', value: '战争' },\r\n  { label: '灾难', value: '灾难' }\r\n];\r\n\r\n\r\ninterface IFormProp {\r\n  onSubmit: (movie: IMovie) => Promise<boolean>\r\n  onSuccessCallback: () => void\r\n  movie?: IMovie\r\n}\r\nclass MovieForm extends React.Component<IFormProp> {\r\n  state = {\r\n    image: '',\r\n    movie: {}\r\n  }\r\n  async onFinish(values: IMovie) {\r\n    values.poster = this.state.image\r\n    const res = await this.props.onSubmit(values)\r\n    if (res) {\r\n      message.success('提交成功', 1, () => {\r\n        console.log('over')\r\n        this.props.onSuccessCallback()\r\n      })\r\n    } else {\r\n      message.error('提交失败')\r\n    }\r\n    return res\r\n  };\r\n  onFinishFailed(errorInfo: any) {\r\n    console.log('Failed:', errorInfo);\r\n  };\r\n  componentDidMount() {\r\n    const movie = this.props.movie\r\n    if (movie) {\r\n      this.setState({\r\n        movie,\r\n        image: movie.poster\r\n      })\r\n    }\r\n  }\r\n  render() {\r\n    const formFile = (newUrl: string) => {\r\n      this.setState({\r\n        image: newUrl\r\n      })\r\n    };\r\n    return (\r\n      <Form\r\n        initialValues={{ ...this.props.movie, poster: this.state.image }}\r\n        labelCol={{ span: 5 }}\r\n        wrapperCol={{ span: 20, offset: 1 }}\r\n        style={{ width: '400px' }}\r\n        onFinish={this.onFinish.bind(this)}\r\n        onFinishFailed={this.onFinishFailed.bind(this)}\r\n      >\r\n        <Form.Item label=\"电影名称\" name=\"name\" rules={[{ required: true, message: '请填写电影名称' }]}>\r\n          <Input></Input>\r\n        </Form.Item>\r\n        <Form.Item label=\"封面图\" name=\"poster\" valuePropName=\"poster\" getValueFromEvent={formFile}>\r\n          <ImageUpload curImageUrl={this.state.image} />\r\n        </Form.Item>\r\n        <Form.Item label=\"地区\" name=\"areas\" rules={[{ required: true, message: '请选择地区' }]}>\r\n          <Checkbox.Group\r\n            options={AllAreas}\r\n          ></Checkbox.Group>\r\n        </Form.Item>\r\n        <Form.Item label=\"类型\" name=\"types\" rules={[{ required: true, message: '请选择类型' }]}>\r\n          <Checkbox.Group\r\n            options={AllTypes}\r\n          ></Checkbox.Group>\r\n        </Form.Item>\r\n        <Form.Item label=\"时长（分钟）\" name=\"timeLong\" rules={[{ required: true, message: '请填写时长' }]}>\r\n          <InputNumber min={1} step={10} />\r\n        </Form.Item>\r\n        <Form.Item label=\"正在热映\" name=\"isHot\" valuePropName=\"checked\">\r\n          <Switch  />\r\n        </Form.Item>\r\n        <Form.Item label=\"即将上映\" name=\"isComing\" valuePropName=\"checked\">\r\n          <Switch  />\r\n        </Form.Item>\r\n        <Form.Item label=\"经典电影\" name=\"isClassic\" valuePropName=\"checked\">\r\n          <Switch  />\r\n        </Form.Item>\r\n        <Form.Item label=\"描述\" name=\"description\">\r\n          <Input.TextArea />\r\n        </Form.Item>\r\n        <Form.Item labelCol={{ span: 5 }} wrapperCol={{ span: 20, offset: 5 }}>\r\n          <Button type=\"primary\" htmlType=\"submit\">提交</Button>\r\n        </Form.Item>\r\n      </Form>\r\n    )\r\n  }\r\n}\r\n\r\nexport default MovieForm","import axios from \"axios\";\r\nimport { IResponseError, IResponstData, IResponstPageData, ISearchCondition } from \"./CommonTypes\";\r\nexport interface IMovie {\r\n  _id?: string\r\n  name: string\r\n  types: string[]\r\n  areas: string[]\r\n  timeLong: number\r\n  isHot: boolean\r\n  isComing: boolean\r\n  isClassic: boolean\r\n  description?: string\r\n  boxOffice?: number\r\n  poster?: string\r\n}\r\nexport class MovieService {\r\n  public static async add(movie: IMovie): Promise<IResponstData<IMovie> | IResponseError>{\r\n    const { data } = await axios.post('/api/movie', movie)\r\n    return data\r\n  }\r\n\r\n  public static async edit(id: string, movie: Partial<IMovie>): Promise<IResponstData<true> | IResponseError>{\r\n    const { data } = await axios.put('/api/movie/' + id, movie)\r\n    return data\r\n  }\r\n\r\n  public static async delete(id: string): Promise<IResponstData<true> | IResponseError>{\r\n    const { data } = await axios.delete('/api/movie/' + id)\r\n    return data\r\n  }\r\n\r\n  public static async getMovieById(id: string): Promise<IResponstData<IMovie | null>> {\r\n    const { data } = await axios.get('/api/movie/' + id)\r\n    return data\r\n  }\r\n\r\n  public static async getMovies(condition: ISearchCondition): Promise<IResponstPageData<IMovie | null>> {\r\n    const { data } = await axios.get('/api/movie/', {\r\n      params: condition\r\n    })\r\n    return data\r\n  }\r\n}","import React from \"react\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport MovieForm from \"../../components/MovieForm\";\r\nimport { MovieService } from \"../../services/MovieService\";\r\n\r\ninterface IParams {\r\n  id: string\r\n}\r\nexport default class extends React.Component<RouteComponentProps<IParams>> {\r\n  state = {\r\n    image: ''\r\n  }\r\n  render() {\r\n    return (\r\n      <MovieForm onSubmit={async (movie) => {\r\n        const rep = await MovieService.add(movie)\r\n        if (rep.err) {\r\n          return false\r\n        } else {\r\n          return true\r\n        }\r\n      }}\r\n      onSuccessCallback={\r\n        () => {\r\n          console.log('aa')\r\n          this.props.history.push('/movie')\r\n        }\r\n      }></MovieForm>\r\n    )\r\n  }\r\n}","import React from \"react\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport MovieForm from \"../../components/MovieForm\";\r\nimport { IMovie, MovieService } from \"../../services/MovieService\";\r\n\r\ninterface IParams {\r\n  id: string\r\n}\r\n\r\ninterface EditMovieState {\r\n  movie?: IMovie\r\n}\r\n\r\nexport default class extends React.Component<RouteComponentProps<IParams>, EditMovieState> {\r\n  state: EditMovieState = {\r\n    movie: undefined\r\n  }\r\n\r\n  async componentDidMount() {\r\n    const rep = await MovieService.getMovieById(this.props.match.params.id)\r\n    console.log(rep, 'rep')\r\n    if (rep.data) {\r\n      this.setState({\r\n        movie: rep.data\r\n      })\r\n    }\r\n  }\r\n  render() {\r\n    return (\r\n      <div>\r\n        {this.state.movie && <MovieForm\r\n          movie={this.state.movie}\r\n          onSubmit={async (movie) => {\r\n            const rep = await MovieService.edit(this.props.match.params.id, movie)\r\n            if (rep.err) {\r\n              return false\r\n            } else {\r\n              return true\r\n            }\r\n          }}\r\n          onSuccessCallback={\r\n            () => {\r\n              console.log('aa')\r\n              this.props.history.push('/movie')\r\n            }\r\n          }></MovieForm>}\r\n      </div>\r\n    )\r\n  }\r\n}","import React from 'react'\r\nimport { IMovieState } from '../redux/reducers/MovieReducer'\r\nimport { Table, Image, Switch, Button, Popconfirm, Input,  } from 'antd'\r\nimport { ColumnProps, TablePaginationConfig } from 'antd/lib/table'\r\nimport { IMovie } from '../services/MovieService'\r\nimport { SwitchType } from '../services/CommonTypes'\r\nimport { NavLink } from 'react-router-dom'\r\nimport { SearchOutlined } from '@ant-design/icons';\r\n\r\n// interface IMovieTableProps extends IMovieState {\r\n//   /**\r\n//    * 完成加载之后的事件\r\n//    */\r\n//   onLoad: () => void\r\n// }\r\nexport interface IMovieTableEvents {\r\n  /**\r\n   * 完成加载之后的事件\r\n   */\r\n  onLoad: () => void\r\n  onSwitchChange: (type: SwitchType, newState: boolean, id: string) => void\r\n  onDelete: (id: string) => Promise<void>\r\n  onPageChange: (newPage: number) => void\r\n  onKeyChange: (key: string) => void\r\n  onSearch: () => void\r\n}\r\nexport default class extends React.Component<IMovieTableEvents & IMovieState> {\r\n\r\n  componentDidMount() {\r\n    if (this.props.onLoad) {\r\n      this.props.onLoad()\r\n    }\r\n  }\r\n\r\n  private handleSearch() {\r\n    this.props.onSearch()\r\n  }\r\n  private getFilterDropDown() {\r\n    return (\r\n      <div style={{padding: 8}}>\r\n        <Input \r\n          style={{width: 188,marginBottom: 8,display: 'block'}}\r\n          value={this.props.condition.key}\r\n          onChange={e => this.props.onKeyChange(e.target.value)}\r\n          onPressEnter={() => this.handleSearch()}\r\n        />\r\n        <Button\r\n          type=\"primary\"\r\n          size=\"small\"\r\n          style={{width: 90, marginRight: 8}}\r\n          onClick={() => this.handleSearch()}>\r\n            搜索\r\n          </Button>\r\n          <Button\r\n          size=\"small\"\r\n          style={{width: 90}}\r\n          onClick={() => {\r\n            this.props.onKeyChange(\"\")\r\n            this.handleSearch()\r\n          }}>\r\n            重置\r\n          </Button>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  private getColumns(): ColumnProps<IMovie>[] {\r\n    return [\r\n      {\r\n        title: \"封面\",\r\n        dataIndex: \"poster\",\r\n        render: (src) => {\r\n          if (src) {\r\n            return (<Image\r\n              width={50}\r\n              height={50}\r\n              src={src}\r\n              preview={false}\r\n            />\r\n            )\r\n          } else {\r\n            return (\r\n              <Image\r\n                width={50}\r\n                height={50}\r\n                src=\"error\"\r\n                fallback=\"data:image/png;base64,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\"\r\n              />\r\n            )\r\n          }\r\n        }\r\n      },\r\n      { \r\n        title: \"名称\", \r\n        dataIndex: \"name\",\r\n        filterDropdown: this.getFilterDropDown.bind(this),\r\n        filterIcon: <SearchOutlined />\r\n      },\r\n      {\r\n        title: \"地区\",\r\n        dataIndex: \"areas\",\r\n        render: (text: string[]) => text.join(', ')\r\n      },\r\n      {\r\n        title: \"类型\",\r\n        dataIndex: \"types\",\r\n        render: (text: string[]) => text.join(', ')\r\n      },\r\n      {\r\n        title: \"时长\",\r\n        dataIndex: \"timeLong\",\r\n        render: timeLong => timeLong + '分钟'\r\n      },\r\n      {\r\n        title: \"正在热映\",\r\n        dataIndex: \"isHot\",\r\n        render: (change, record) => {\r\n          return (\r\n            <Switch checked={change} onChange={(newVal) => {\r\n              this.props.onSwitchChange(SwitchType.isHot, newVal, record._id!)\r\n            }} />\r\n          )\r\n        }\r\n      },\r\n      {\r\n        title: \"即将上映\",\r\n        dataIndex: \"isComing\",\r\n        render: (change, record) => {\r\n          return (\r\n            <Switch checked={change} onChange={(newVal) => {\r\n              this.props.onSwitchChange(SwitchType.isComing, newVal, record._id!)\r\n            }} />\r\n          )\r\n        }\r\n      },\r\n      {\r\n        title: \"经典影片\",\r\n        dataIndex: \"isClassic\",\r\n        render: (change, record) => {\r\n          return (\r\n            <Switch checked={change} onChange={(newVal) => {\r\n              this.props.onSwitchChange(SwitchType.isClassic, newVal, record._id!)\r\n            }} />\r\n          )\r\n        }\r\n      },\r\n      { title: \"票房\", dataIndex: \"boxOffice\" },\r\n      {\r\n        title: \"操作\",\r\n        dataIndex: \"_id\",\r\n        render: (id: string) => {\r\n          return (\r\n            <div>\r\n              <NavLink to={'/movie/edit/' + id}>\r\n                <Button type=\"primary\">编辑</Button>\r\n              </NavLink>\r\n              <Popconfirm title=\"确定要删除？\" onConfirm={\r\n                () => {\r\n                  this.props.onDelete(id)\r\n                }\r\n              } okText=\"确定\" cancelText=\"取消\">\r\n                <Button type=\"default\">删除</Button>\r\n              </Popconfirm>\r\n            </div >\r\n          )\r\n        }\r\n      },\r\n    ]\r\n  }\r\n\r\n  getPageConfig(): TablePaginationConfig | false {\r\n    if (!this.props.total) return false\r\n    return {\r\n      current: this.props.condition.page,\r\n      pageSize: this.props.condition.limit,\r\n      total: this.props.total\r\n    }\r\n  }\r\n\r\n  handleChange(pagination: TablePaginationConfig) {\r\n    this.props.onPageChange(pagination.current!)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Table\r\n        rowKey=\"_id\"\r\n        dataSource={this.props.data}\r\n        columns={this.getColumns()}\r\n        loading={ this.props.isLoading }\r\n        pagination={this.getPageConfig()}\r\n        onChange={ this.handleChange.bind(this) }\r\n      />\r\n    )\r\n  }\r\n}","import { ThunkAction } from \"redux-thunk\";\r\nimport { ISearchCondition, SwitchType } from \"../../services/CommonTypes\";\r\nimport { IMovie, MovieService } from \"../../services/MovieService\";\r\nimport { IAction } from \"../actions/ActionTypes\";\r\nimport { IRootState } from \"../reducers/RootReducer\";\r\n\r\nexport type SaveMoviesAction = IAction<\"movie_save\", {\r\n  movies: IMovie[],\r\n  total: number\r\n}>\r\nfunction saveMoviesAction(movies: any, total: number): SaveMoviesAction {\r\n  return {\r\n    type: 'movie_save',\r\n    payload: {\r\n      movies,\r\n      total\r\n    }\r\n  }\r\n}\r\n\r\nexport type SetLoadingAction = IAction<\"movie_setLoading\", boolean>\r\nfunction setLoadingAction(isLoading: boolean): SetLoadingAction {\r\n  return {\r\n    type: 'movie_setLoading',\r\n    payload: isLoading\r\n  }\r\n}\r\n\r\nexport type SetConditionAction = IAction<\"movie_setCondition\", ISearchCondition>\r\nfunction setConditionAction(condition: ISearchCondition): SetConditionAction {\r\n  return {\r\n    type: 'movie_setCondition',\r\n    payload: condition\r\n  }\r\n}\r\n\r\nexport type DeleteAction = IAction<\"movie_delete\", string>\r\nfunction deleteAction(id: string): DeleteAction {\r\n  return {\r\n    type: 'movie_delete',\r\n    payload: id\r\n  }\r\n}\r\n\r\nexport type MovieSwitchChangeAction = IAction<'movie_switch', {\r\n  type: SwitchType,\r\n  newVal: boolean,\r\n  id: string\r\n}>\r\nfunction changeSwitchAction(type: SwitchType, newVal: boolean, id: string): MovieSwitchChangeAction {\r\n  return {\r\n    type: 'movie_switch',\r\n    payload: {\r\n      type,\r\n      newVal,\r\n      id\r\n    }\r\n  }\r\n}\r\n\r\nexport type MovieActions = SaveMoviesAction | SetConditionAction | SetLoadingAction | DeleteAction | MovieSwitchChangeAction\r\n\r\n// 根据条件从服务器获取电影数据\r\nfunction fetchMovies(condition: ISearchCondition): ThunkAction<Promise<void>, IRootState, any, MovieActions> {\r\n  return async (dispatch, getState) => {\r\n    // 1.设置加载状态\r\n    dispatch(setLoadingAction(true))\r\n    // 2.设置条件\r\n    dispatch(setConditionAction(condition))\r\n    // 3.获取服务器数据\r\n    const curCondition = getState().movie.condition\r\n    const res = await MovieService.getMovies(curCondition)\r\n    // 4.更改仓库数据\r\n    dispatch(saveMoviesAction(res.data, res.total))\r\n    // 5.关闭加载状态\r\n    dispatch(setLoadingAction(false))\r\n  }\r\n}\r\n\r\nfunction deleteMovie(id: string): ThunkAction<Promise<void>, IRootState, any, MovieActions> {\r\n  return async dispatch => {\r\n    dispatch(setLoadingAction(true))\r\n    await MovieService.delete(id)\r\n    // 删除本地仓库数据\r\n    dispatch(deleteAction(id))\r\n    dispatch(setLoadingAction(false))\r\n  }\r\n}\r\n\r\nfunction changeSwitch(type: SwitchType, newVal: boolean, id: string): ThunkAction<Promise<void>, IRootState, any, MovieActions> {\r\n  return async dispatch => {\r\n    dispatch(changeSwitchAction(type, newVal, id))\r\n    await MovieService.edit(id, {\r\n      [type]: newVal\r\n    })\r\n  }\r\n}\r\nexport default {\r\n  saveMoviesAction,\r\n  setConditionAction,\r\n  setLoadingAction,\r\n  deleteAction,\r\n  fetchMovies,\r\n  deleteMovie,\r\n  changeSwitchAction,\r\n  changeSwitch\r\n}","import { Dispatch } from \"react\";\r\nimport MovieTable, { IMovieTableEvents } from \"../../components/MovieTable\";\r\n\r\nimport { connect } from 'react-redux'\r\nimport { IRootState } from \"../../redux/reducers/RootReducer\";\r\nimport MovieAction from \"../../redux/actions/MovieAction\";\r\nimport { IMovieState } from \"../../redux/reducers/MovieReducer\";\r\n\r\nfunction mapStateToProps(state: IRootState): IMovieState {\r\n  return state.movie\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<any>): IMovieTableEvents {\r\n  return {\r\n    onLoad() {\r\n      dispatch(MovieAction.fetchMovies({\r\n        page: 1,\r\n        limit: 10,\r\n        key: ''\r\n      }))\r\n    },\r\n    onSwitchChange(type, newState, id) {\r\n      dispatch(MovieAction.changeSwitch(type, newState, id))\r\n    },\r\n    async onDelete(id) {\r\n      await dispatch(MovieAction.deleteMovie(id))\r\n    },\r\n    onPageChange(newPage) {\r\n      dispatch(MovieAction.fetchMovies({\r\n        page: newPage\r\n      }))\r\n    },\r\n    onKeyChange(newKey) {\r\n      dispatch(MovieAction.setConditionAction({\r\n        key: newKey\r\n      }))\r\n    },\r\n    onSearch() {\r\n      dispatch(MovieAction.fetchMovies({\r\n        page: 1\r\n      }))\r\n    }\r\n  }\r\n}\r\n\r\n// const HOC = connect(mapStateToProps)\r\n// const MovieContainer = HOC(MovieTable)\r\n\r\n// export default class extends React.Component {\r\n//   render() {\r\n//     return (\r\n//       <MovieContainer />\r\n//     )\r\n//   }\r\n// }\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MovieTable)","import { Layout, Menu } from \"antd\"\r\nimport React from \"react\"\r\nimport { NavLink, Route } from \"react-router-dom\"\r\nimport Home from \"./Home\"\r\nimport AddMovie from \"./movie/AddMovie\"\r\nimport EditMovie from \"./movie/EditMovie\"\r\nimport MovieList from \"./movie/MovieList\"\r\n\r\nconst { Header, Sider, Content } = Layout;\r\n\r\nconst _Layout: React.FC = function () {\r\n  return (\r\n    <div className=\"container\">\r\n      <Layout>\r\n        <Header className=\"header\">\r\n          <NavLink to=\"/\">猫眼电影管理系统</NavLink>\r\n        </Header>\r\n\r\n        <Layout>\r\n          <Sider>\r\n            <Menu mode=\"inline\" theme=\"dark\">\r\n              <Menu.Item key=\"1\">\r\n                <NavLink to=\"/\">首页</NavLink>\r\n              </Menu.Item>\r\n              <Menu.Item key=\"2\">\r\n                <NavLink to=\"/movie\">电影列表</NavLink>\r\n              </Menu.Item>\r\n              <Menu.Item key=\"3\">\r\n                <NavLink to=\"/movie/add\">添加电影</NavLink>\r\n              </Menu.Item>\r\n              <Menu.Item key=\"4\">\r\n                <NavLink to=\"/movie/edit/234\">编辑电影</NavLink>\r\n              </Menu.Item>\r\n            </Menu>\r\n          </Sider>\r\n          <Content>\r\n            <div className=\"main\">\r\n              <Route path=\"/\" component={Home} exact></Route>\r\n              <Route path=\"/movie\" component={MovieList} exact></Route>\r\n              <Route path=\"/movie/add\" component={AddMovie}></Route>\r\n              <Route path=\"/movie/edit/:id\" component={EditMovie}></Route>\r\n            </div>\r\n          </Content>\r\n        </Layout>\r\n      </Layout>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default _Layout","import { Reducer } from \"react\";\r\nimport { ISearchCondition } from \"../../services/CommonTypes\";\r\nimport { IMovie } from \"../../services/MovieService\";\r\nimport { DeleteAction, MovieActions, MovieSwitchChangeAction, SaveMoviesAction, SetConditionAction, SetLoadingAction } from \"../actions/MovieAction\";\r\n\r\nexport type IMovieCondition = Required<ISearchCondition> \r\nexport interface IMovieState {\r\n  /**\r\n   * 电影数组\r\n   */\r\n  data: IMovie[]\r\n\r\n  /**\r\n   * 查询条件\r\n   */\r\n  condition: IMovieCondition\r\n\r\n  /**\r\n   * 总记录数\r\n   */\r\n  total: number\r\n\r\n  /**\r\n   * 是否正在加载数据\r\n   */\r\n  isLoading: boolean\r\n\r\n  /**\r\n   * 总页数\r\n   */\r\n  totalPage: number\r\n}\r\n\r\nconst defaultState: IMovieState = {\r\n  data: [],\r\n  condition: {\r\n    page: 1,\r\n    limit: 10,\r\n    key: ''\r\n  },\r\n  total: 0,\r\n  isLoading: false,\r\n  totalPage: 0\r\n}\r\n\r\ntype MovieReducer<A> = Reducer<IMovieState, A>\r\n\r\nconst saveMovie: MovieReducer<SaveMoviesAction> = function(state, action) {\r\n  // 写法一\r\n  return Object.assign({}, state, {\r\n    total: action.payload.total,\r\n    data: action.payload.movies,\r\n    totalPage: Math.ceil(action.payload.total / state.condition.limit)\r\n  })\r\n  // 写法二\r\n  return {\r\n    ...state,\r\n    total: action.payload.total,\r\n    data: action.payload.movies\r\n  }\r\n}\r\n\r\nconst setCondtion: MovieReducer<SetConditionAction> = function(state, action) {\r\n  const newState = {\r\n    ...state,\r\n    condition: {\r\n      ...state.condition,\r\n      ...action.payload\r\n    }\r\n  }\r\n  newState.totalPage = Math.ceil(newState.total / newState.condition.limit)\r\n  return newState\r\n}\r\n\r\n\r\nconst setLoading: MovieReducer<SetLoadingAction> = function(state, action) {\r\n  return {\r\n    ...state,\r\n    isLoading: action.payload\r\n  }\r\n}\r\n\r\nconst deleteMovie: MovieReducer<DeleteAction> = function(state, action) {\r\n  return {\r\n    ...state,\r\n    data: state.data.filter(m => m._id !== action.payload),\r\n    total: state.total - 1,\r\n    totalPage: Math.ceil((state.total - 1) / state.condition.limit)\r\n  }\r\n}\r\n\r\nconst changeSwitch: MovieReducer<MovieSwitchChangeAction> = function(state, action) {\r\n  // 根据id找到对象\r\n  const movie = state.data.find(d => d._id === action.payload.id)\r\n  if (!movie) return state\r\n  // 克隆\r\n  const newMovie = {  ...movie }\r\n  newMovie[action.payload.type] = action.payload.newVal\r\n  // 将对象重新放回数组\r\n  const newData = state.data.map(d => {\r\n    if (d._id === action.payload.id) {\r\n      return newMovie\r\n    }\r\n    return d\r\n  })\r\n  return {\r\n    ...state,\r\n    data: newData\r\n  }\r\n}\r\n\r\nexport default function(state: IMovieState = defaultState, action: MovieActions) {\r\n  switch(action.type) {\r\n    case 'movie_save':\r\n      return saveMovie(state, action)\r\n    case 'movie_setCondition':\r\n      return setCondtion(state, action)\r\n    case 'movie_setLoading':\r\n      return setLoading(state, action)\r\n    case 'movie_delete':\r\n      return deleteMovie(state, action)\r\n    case 'movie_switch':\r\n      return changeSwitch(state, action)\r\n    default:\r\n      return state\r\n  }\r\n}","import { combineReducers } from \"redux\";\r\nimport movie, { IMovieState } from \"./MovieReducer\";\r\n\r\nexport interface IRootState {\r\n  movie: IMovieState\r\n}\r\nexport const rootReducer = combineReducers({\r\n  movie\r\n})","import { applyMiddleware, createStore } from \"redux\"\r\nimport { IRootState, rootReducer } from \"./reducers/RootReducer\"\r\nimport logger from \"redux-logger\"\r\nimport thunk, { ThunkMiddleware } from \"redux-thunk\"\r\n\r\nexport const store = createStore(\r\n  rootReducer,\r\n  applyMiddleware(thunk as ThunkMiddleware<IRootState>, logger)\r\n)","import Layout from './pages/Layout';\nimport { BrowserRouter, Route } from 'react-router-dom'\nimport { Provider } from 'react-redux'\nimport { store } from './redux/store';\nfunction App() {\n  return (\n    <Provider store={store}>\n      <BrowserRouter>\n        <Route path=\"/\" component={ Layout }></Route>\n      </BrowserRouter>\n    </Provider>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport \"antd/dist/antd.css\"\nimport App from './App';\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}